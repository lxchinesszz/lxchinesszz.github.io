<!DOCTYPE HTML>
<html lang="zh-CN">
<head>
    <!--Setting-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="apple-mobile-web-app-capable" content="程序猿升级课">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    <meta name="browsermode" content="application">
    <meta name="baidu-site-verification" content="VoeZU7FyND" />
    <meta name="screen-orientation" content="portrait">
    <link rel="dns-prefetch" href="https://lxchinesszz.github.io">
    <!--SEO-->

<meta name="description" content="一个关注于程序猿技术提升的博客"/>





<meta name="robots" content="all" />
<meta name="google" content="all" />
<meta name="googlebot" content="all" />
<meta name="verify" content="all" />
    <!--Title-->


<title>Netty组件介绍 | 程序猿升级课</title>


    <link rel="alternate" href="/atom.xml" title="程序猿升级课" type="application/atom+xml">


    <link rel="icon" href="http://lxchinesszz.gitee.io/chinesszz/favicon.ico">

    



<link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.4/css/bootstrap.min.css?rev=3.3.4">
<link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="/css/style.css?rev=@@hash">




    
	<div class="hide">
		<script type="text/javascript">
			var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan class='cnzz_stat_icon_1263868967 hide' %3E%3Cscript%20src%3D%22https%3A%2F%2Fs95.cnzz.com%2Fz_stat.php%3Fweb_id%3D1272564536%22%3E%3C%2Fscript%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s19.cnzz.com/z_stat.php%3Fid%3D1263868967%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));
		</script>
	</div>






    
</head>

<script src="https://cdn1.lncld.net/static/js/av-min-1.2.1.js"></script>
<!--统计浏览量-->
<script>AV.init('IwOl4kKmvkph85YhYWKm26tr-gzGzoHsz', 'N1rlzE7cJFetMehvtgaHnKhB');</script>


<!--[if lte IE 8]>
<style>
    html{ font-size: 1em }
</style>
<![endif]-->
<!--[if lte IE 9]>
<div style="ie">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div>
<![endif]-->

<body>
    <header class="main-header"  >
    <div class="main-header-box">
        <a class="header-avatar" href="/" title='liuxin'>
            <img src="/img/avatar.jpg" alt="logo头像" class="img-responsive center-block">
        </a>
        <div class="branding">
        	<!--<h2 class="text-hide">Snippet主题,从未如此简单有趣</h2>-->
            
                <h2> 科技改变生活! </h2>
            
    	</div>
    </div>
</header>
    <nav class="main-navigation">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="navbar-header"><span class="nav-toggle-button collapsed" data-toggle="collapse" data-target="#main-menu" id="mnav">
                    <span class="sr-only"></span>
                        <i class="fa fa-bars"></i>
                    </span>
                </div>
                <div class="collapse navbar-collapse" id="main-menu">
                    <ul class="menu">
                        
                            <li role="presentation" class="text-center">
                                <a href="/"><i class="fa "></i>首页</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/Spring-Boot/"><i class="fa "></i>SpringBoot</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/Spring-Boot2-0/"><i class="fa "></i>SpringBoot2.0</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/Spring-Cloud/"><i class="fa "></i>SpringCloud</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/通信/"><i class="fa "></i>通信</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/数据处理/"><i class="fa "></i>数据处理</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/源码阅读/"><i class="fa "></i>源码阅读</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/杂记/"><i class="fa "></i>杂记</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/2015/03/11/me/"><i class="fa "></i>关于</a>
                            </li>
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>
</nav>
    <section class="content-wrap">
        <div class="container">
            <div class="row">
                <main class="col-md-8 main-content m-post">
                    <p id="process"></p>
<article class="post">
    <div class="post-head">
        <h1 id="Netty组件介绍">
            
	            Netty组件介绍
            
        </h1>
        <div class="post-meta">
    
    
    <span class="categories-meta fa-wrap">
        <i class="fa fa-folder-open-o"></i>
        <a href="/categories/通信">
            通信
        </a>
    </span>
    
    
    <span class="fa-wrap">
        <i class="fa fa-tags"></i>
        <span class="tags-meta">
            
                
                    <a href="/tags/Netty" title='Netty'>
                        Netty
                    </a>
                
            
        </span>
    </span>
    <!-- 添加作者-->
    <span class="fa-wrap">
        <i class="fa fa-user" aria-hidden="true"></i>
        <span>
            
                liuxin
             
        </span>
    </span>

    

    
        
        <span class="fa-wrap">
            <i class="fa fa-clock-o"></i>
            <span class="date-meta">2018/04/11</span>
        </span>
         <span id="busuanzi_container_page_pv">
                              被围观:<span id="busuanzi_value_page_pv" ></span>次
                            </span>
    
</div>

            
            
    </div>
    
    <div class="post-body post-content">
        <blockquote>
<p>在学习Netty之前，建议首先学习一个NIO，对关键的NIO组件有一个清醒认识</p>
</blockquote>
<p><a href="http://www.jianshu.com/p/2124e919158a" target="_blank" rel="noopener">Buffer</a></p>
<p><a href="http://blog.csdn.net/suifeng3051/article/details/48441629" target="_blank" rel="noopener">Selector</a></p>
<h2 id="总览"><a href="#总览" class="headerlink" title="总览"></a>总览</h2><ul>
<li>Bootstrap or ServerBootstrap</li>
<li>EventLoop</li>
<li>EventLoopGroup</li>
<li>ChannelPipeline</li>
<li>Future or ChannelFuture</li>
<li>ChannelInitializer</li>
<li>ChannelHandler</li>
<li>ByteToMessageDecoder</li>
<li>MessageToByteEncoder</li>
<li>ChannelPipline</li>
<li>Channel</li>
<li>ChannelHandlerContext</li>
</ul>
<h3 id="ServerBootstrap"><a href="#ServerBootstrap" class="headerlink" title="ServerBootstrap"></a>ServerBootstrap</h3><p><em>一个Netty应用通常由一个Bootstrap开始，它主要作用是配置整个Netty程序，串联起各个组件。</em></p>
<ul>
<li>option() 针对boss线程,用于连接 </li>
<li>childOption() 针对work线程,用于处理数据 </li>
</ul>
<h4 id="BootStrap"><a href="#BootStrap" class="headerlink" title="BootStrap"></a>BootStrap</h4><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">EventLoopGroup group = <span class="keyword">new</span> NioEventLoopGroup();</span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line">           Bootstrap bootstrap = <span class="keyword">new</span> Bootstrap();</span><br><span class="line">           bootstrap.group(group).channel(NioSocketChannel.class)</span><br><span class="line">                   .remoteAddress(<span class="keyword">new</span> InetSocketAddress(host, port))</span><br><span class="line">                   .<span class="keyword">handler</span>(<span class="keyword">new</span> ChannelInitializer&lt;SocketChannel&gt;() &#123;</span><br><span class="line">                       <span class="meta">@Override</span></span><br><span class="line">                       <span class="keyword">protected</span> <span class="function"><span class="keyword">void</span> <span class="title">initChannel</span><span class="params">(SocketChannel socketChannel)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">                           ChannelPipeline pipeline = socketChannel.pipeline();</span><br><span class="line">                           pipeline.addLast(<span class="keyword">new</span> SimpleChannelInboundHandler&lt;ByteBuf&gt;() &#123;</span><br><span class="line">                               <span class="comment">//在连接的时候将数据发送给</span></span><br><span class="line">                               <span class="meta">@Override</span></span><br><span class="line">                               <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">channelActive</span><span class="params">(ChannelHandlerContext ctx)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">                                   ctx.channel().writeAndFlush(request);</span><br><span class="line">                               &#125;</span><br><span class="line"></span><br><span class="line">                               <span class="comment">//接受信息</span></span><br><span class="line">                               <span class="meta">@Override</span></span><br><span class="line">                               <span class="keyword">protected</span> <span class="function"><span class="keyword">void</span> <span class="title">messageReceived</span><span class="params">(ChannelHandlerContext channelHandlerContext, ByteBuf byteBuf)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">                                   result = <span class="keyword">new</span> <span class="keyword">byte</span>[byteBuf.readableBytes()];</span><br><span class="line">                                   byteBuf.readBytes(result);</span><br><span class="line">                               &#125;</span><br><span class="line">                           &#125;);</span><br><span class="line">                       &#125;</span><br><span class="line">                   &#125;);</span><br><span class="line">           ChannelFuture future = bootstrap.connect().sync();</span><br><span class="line">           future.addListener(ChannelFutureListener.CLOSE).sync();</span><br></pre></td></tr></table></figure>
<h3 id="EventLoop"><a href="#EventLoop" class="headerlink" title="EventLoop"></a>EventLoop</h3><p><em>一个EventLoop可以为多个Channel服务。</em> EventLoopGroup会包含多个EventLoop</p>
<h3 id="ChannelPipeline-ChannelHandler"><a href="#ChannelPipeline-ChannelHandler" class="headerlink" title="ChannelPipeline,ChannelHandler"></a>ChannelPipeline,ChannelHandler</h3><p><em>从PipeLine这个单词中可以看出来，是一个管道，处理连接。我们的业务代码handler一般都是放在这个管道中的</em></p>
<p><strong>那么疑问来了，这个管道中的处理顺序是什么样呢？</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ChannelPipeline cp = channel.pipeline(); </span><br><span class="line">cp.addLast(<span class="string">"encoder"</span>, <span class="keyword">new</span> HttpResponseEncoder());<span class="comment">//1.负责输出</span></span><br><span class="line">cp.addLast(<span class="string">"decoder"</span>, <span class="keyword">new</span> HttpRequestDecoder());<span class="comment">//2.负责把客户端的数据解码</span></span><br><span class="line">cp.addLast(<span class="string">"handler"</span>, <span class="keyword">new</span> HttpDispatchServerHandler());<span class="comment">//3.自定义的业务处理器</span></span><br></pre></td></tr></table></figure>
<p>按照我们执行顺序肯定不是根据添加顺序来处理的，应该是:2,把客户端的数据解码-&gt;3.对解码数据处理-&gt;1.加密返回给客户端。</p>
<p>那么 <code>Netty</code> 是怎么处理的呢？</p>
<p><img src="http://img.blog.csdn.net/20140606105045406?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc3VpZmVuZzMwNTE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=""></p>
<p><em>ChannelHandler有两个子类ChannelInboundHandler和ChannelOutboundHandler，这两个类对应了两个数据流向，如果数据是从外部流入我们的应用程序，我们就看做是inbound，相反便是outbound</em></p>
<p><img src="http://img.blog.csdn.net/20140606105113171?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc3VpZmVuZzMwNTE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=""></p>
<h3 id="ChannelInitializer"><a href="#ChannelInitializer" class="headerlink" title="ChannelInitializer"></a>ChannelInitializer</h3><p><em>顾名思义,这个就是channel初始化的容器，在这个里面设置处理器</em></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">ServerBootstrap bootstrap = <span class="keyword">new</span> ServerBootstrap();</span><br><span class="line">       bossGroup = <span class="keyword">new</span> NioEventLoopGroup();<span class="comment">//负责绑定channel到selector</span></span><br><span class="line">       workerGroup = <span class="keyword">new</span> NioEventLoopGroup();<span class="comment">//负责从selector中读取事件</span></span><br><span class="line">       bootstrap.group(bossGroup, workerGroup).channel(NioServerSocketChannel.class)</span><br><span class="line">               .localAddress(<span class="number">6969</span>).option(ChannelOption.CONNECT_TIMEOUT_MILLIS, <span class="number">10000</span>)</span><br><span class="line">               .childOption(ChannelOption.SO_KEEPALIVE, <span class="keyword">true</span>).childHandler(<span class="keyword">new</span> ChannelInitializer&lt;Channel&gt;() &#123;</span><br><span class="line">           <span class="meta">@Override</span></span><br><span class="line">           <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">initChannel</span><span class="params">(Channel channel)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">               ChannelPipeline cp = channel.pipeline();</span><br><span class="line">               cp.addLast(<span class="string">"idleStateHandler"</span>, <span class="keyword">new</span> IdleStateHandler(<span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, TimeUnit.SECONDS));</span><br><span class="line">               cp.addLast(<span class="string">"decoder"</span>, <span class="keyword">new</span> HttpRequestDecoder());</span><br><span class="line">               cp.addLast(<span class="string">"encoder"</span>, <span class="keyword">new</span> HttpResponseEncoder());</span><br><span class="line">               cp.addLast(<span class="string">"aggregator"</span>, <span class="keyword">new</span> HttpObjectAggregator(<span class="number">1048576</span>));</span><br><span class="line">               cp.addLast(<span class="string">"deflater"</span>, <span class="keyword">new</span> HttpContentCompressor());</span><br><span class="line">               cp.addLast(<span class="string">"handler"</span>, <span class="keyword">new</span> HttpDispatchServerHandler());</span><br><span class="line">               cp.addLast(<span class="string">"out"</span>, <span class="keyword">new</span> AcceptorIdleStateTrigger());</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;).option(ChannelOption.SO_BACKLOG, <span class="number">128</span>);</span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line">           channel = bootstrap.bind().awaitUninterruptibly().channel();</span><br><span class="line">           showBanner(<span class="number">6969</span>);</span><br><span class="line">       &#125; <span class="keyword">catch</span> (Exception ie) &#123;</span><br><span class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(ie);</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure>
<p>###ChannelFuture</p>
<p><em>Netty中的连接都可以是异步的，但是也可以设置为非异步</em></p>
<h5 id="ChannelFuture"><a href="#ChannelFuture" class="headerlink" title="ChannelFuture"></a>ChannelFuture</h5><p><code>Channel</code> 每个操作都会返回一个 <code>ChannelFutrue</code> 因为是异步的，所以我们为每个异步的结果，添加一个监听,比如:</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 当完成关闭动作，就执行监听器内容</span></span><br><span class="line">f = f.channel().closeFuture().<span class="keyword">await</span>();  </span><br><span class="line">f.addListener(<span class="keyword">new</span> ChannelFutureListener() &#123;  </span><br><span class="line">    @Override  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operationComplete</span>(<span class="params">ChannelFuture future</span>) throws Exception </span>&#123;  </span><br><span class="line">        System.<span class="keyword">out</span>.println(<span class="string">"success complete!!ok!!"</span>);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>当然还有一种方法， 就是await()，此返回会等待上一个操作完成，在进行下一个操作。但是推荐使用第一种。</p>
<h3 id="ByteToMessageDecoder"><a href="#ByteToMessageDecoder" class="headerlink" title="ByteToMessageDecoder"></a>ByteToMessageDecoder</h3><p><em>解密器，可以自定义协议，通过集成改接口，重写 <code>decode</code> 方法把二进制，转换为我们系统可以处理的对象</em></p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io.netty.buffer.<span class="type">ByteBuf</span>;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.<span class="type">ChannelHandlerContext</span>;</span><br><span class="line"><span class="keyword">import</span> io.netty.handler.codec.<span class="type">ByteToMessageDecoder</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.<span class="type">List</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 把字节转换为int</span></span><br><span class="line"><span class="comment"> * 继承抽象类ByteToMessageDecoder实现解码器</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">ByteToIntegerDecoder</span> <span class="keyword">extends</span> <span class="title">ByteToMessageDecoder</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    public void decode(<span class="type">ChannelHandlerContext</span> ctx, <span class="type">ByteBuf</span> in,</span><br><span class="line">                       <span class="type">List</span>&lt;<span class="type">Object</span>&gt; out) <span class="keyword">throws</span> <span class="type">Exception</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (in.readableBytes() &gt;= <span class="number">4</span>) &#123;  <span class="comment">// Check if there are at least 4 bytes readable</span></span><br><span class="line">            int n = in.readInt();</span><br><span class="line">            <span class="type">System</span>.err.println(<span class="string">"ByteToIntegerDecoder decode msg is "</span> + n);</span><br><span class="line">            out.add(n);      <span class="comment">//Read integer from inbound ByteBuf, add to the List of decodec messages</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="编码器"><a href="#编码器" class="headerlink" title="编码器"></a>编码器</h3><p><em>将我们系统处理完的信息，编码成，二进制，传出，给调用者</em></p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io.netty.buffer.<span class="type">ByteBuf</span>;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.<span class="type">ChannelHandlerContext</span>;</span><br><span class="line"><span class="keyword">import</span> io.netty.handler.codec.<span class="type">MessageToByteEncoder</span>;</span><br><span class="line"></span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">IntegerToByteEncoder</span> <span class="keyword">extends</span> <span class="title">MessageToByteEncoder&lt;Integer&gt;</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    public void encode(<span class="type">ChannelHandlerContext</span> ctx, <span class="type">Integer</span> msg, <span class="type">ByteBuf</span> out)</span><br><span class="line">            <span class="keyword">throws</span> <span class="type">Exception</span> &#123;</span><br><span class="line">        <span class="type">System</span>.err.println(<span class="string">"IntegerToByteEncoder encode msg is "</span> + msg);</span><br><span class="line">        out.writeInt(msg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="解码后的数据怎么使用"><a href="#解码后的数据怎么使用" class="headerlink" title="解码后的数据怎么使用"></a>解码后的数据怎么使用</h3><p>对于加密后的数据，可以直接强制转换为我们解码的对象</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">BusinessHandler</span> <span class="keyword">extends</span> <span class="title">ChannelInboundHandlerAdapter</span> </span>&#123;</span><br><span class="line">true<span class="keyword">private</span> <span class="type">Logger</span>	logger	= <span class="type">LoggerFactory</span>.getLogger(<span class="type">BusinessHandler</span>.<span class="keyword">class</span>);</span><br><span class="line"></span><br><span class="line">true<span class="meta">@Override</span></span><br><span class="line">truepublic void channelRead(<span class="type">ChannelHandlerContext</span> ctx, <span class="type">Object</span> msg) <span class="keyword">throws</span> <span class="type">Exception</span> &#123;</span><br><span class="line">true<span class="comment">//因为我们的解码其中指定是Int类型，所以我们就可以，强制转换为Int，这里为了好理解，假如我们的解码器，中是转换了Person，那么在我们的处理器中就，可以强制换换为Person</span></span><br><span class="line">truetrue<span class="type">Person</span> person = (<span class="type">Person</span>) msg;</span><br><span class="line">truetruelogger.info(<span class="string">"BusinessHandler read msg from client :"</span> + person);</span><br><span class="line">true&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ChannelPipline-管道"><a href="#ChannelPipline-管道" class="headerlink" title="ChannelPipline 管道"></a>ChannelPipline 管道</h3><ul>
<li>管道中包括(ChannleInBoundHandler)入栈的和(ChannelOutBoundHandler)出栈的<br>当连接发生,由ChannelPipline协调将消息给ChannelHandler处理</li>
</ul>
<ul>
<li>当一个ChannelHandler被绑定在了多个ChannelPipeline实例上,为了线程安全会报错.要使用<code>@Sharable</code>注解</li>
</ul>
<h3 id="Channel-消息的传载实体"><a href="#Channel-消息的传载实体" class="headerlink" title="Channel 消息的传载实体"></a>Channel 消息的传载实体</h3><h3 id="ChannelHandlerContext"><a href="#ChannelHandlerContext" class="headerlink" title="ChannelHandlerContext"></a>ChannelHandlerContext</h3><ul>
<li>ChannelHandlerContext将Channel和ChannelHandler做一个关联<br>因为一个Channel可能与多个ChannelHandler绑定</li>
</ul>
<p><strong>注意</strong><br>ChannelHandler与下一个ChannelHandler…的交互并不是他们直接产生的,而是有ChannelHandlerContext调用的</p>
<p><em>从中学习到一个编程技巧,就是当一个实体与多个处理器产生关系的时候,可以定义一个上下文,用来管理关系</em></p>
<p><img src="https://note.youdao.com/yws/api/personal/file/WEB07292465a4b07d6a3bb94f21306545bb?method=download&amp;shareKey=810191250b7598a58d95ef85ba433af0" alt=""></p>

        <!--打赏模块-->
          
               <! -- 添加捐赠图标 -->
<div class ="post-donate">
    <div id="donate_board" class="donate_bar center">
        <a id="btn_donate_a"  href="javascript:;" onclick="aClick()" title="打赏."></a>
        <span class="donate_txt">
           &uarr;<br>
           如果您觉得文章对你有用,可以赏我一杯咖啡
        </span>
        <br>
      </div>
    <div id="donate_guide" class="donate_bar" >
          <!-- 微信打赏图案 -->
        <img src="http://otjenik28.bkt.clouddn.com/wwx.png"
    </div>
    <script type="text/javascript">
       function aClick(){
            <!--元素隐藏，但是原由位置不隐藏-->
                        document.getElementById("donate_board").style.visibility="hidden";
                         <!--隐藏原由位置-->
                        document.getElementById("donate_board").style.display="none";
                        document.getElementById("donate_board").style.marginRight='auto';
             			document.getElementById("donate_board").style.marginLeft='auto';
                        document.getElementById("donate_guide").style.visibility="visible";
                        document.getElementById("donate_guide").style.display="inline";
                        document.getElementById("donate_guide").style.marginRight='auto';
             			document.getElementById("donate_guide").style.marginLeft='auto';

        }
    </script>
</div>
<! -- 添加捐赠图标 -->

          
    </div>

    <div class="post-footer">
        <div>
            
                转载声明：商业转载请联系作者获得授权,非商业转载请注明出处 © <a href="" target="_blank">lxchinesszz</a>
            
        </div>
        <div>
            
        </div>
    </div>
</article>

<div class="article-nav prev-next-wrap clearfix">
    
        <a href="/2018/04/13/忘掉那些所谓的真理，请继续重复发明好轮子/" class="pre-post btn btn-default" title='忘掉那些所谓的真理，请继续重复发明好轮子'>
            <i class="fa fa-angle-left fa-fw"></i><span class="hidden-lg">上一篇</span>
            <span class="hidden-xs">忘掉那些所谓的真理，请继续重复发明好轮子</span>
        </a>
    
    
        <a href="/2018/01/12/SpringBoot整合Data-Jpa/" class="next-post btn btn-default" title='SpringBoot整合Data-Jpa'>
            <span class="hidden-lg">下一篇</span>
            <span class="hidden-xs">SpringBoot整合Data-Jpa</span><i class="fa fa-angle-right fa-fw"></i>
        </a>
    
</div>


    <div id="comments">
        
	
<div id="lv-container" data-id="city" data-uid="MTAyMC8zNTY3NC8xMjIxMA==">
  <script type="text/javascript">
     (function(d, s) {
         var j, e = d.getElementsByTagName(s)[0];
         if (typeof LivereTower === 'function') { return; }
         j = d.createElement(s);
         j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
         j.async = true;
         e.parentNode.insertBefore(j, e);
     })(document, 'script');
  </script>
</div>


    </div>





                </main>
                
    <aside class="col-md-4 sidebar">
        
        
    <div class="widget">
        <h3 class="title">搜索</h3>
        <div id="search-form">
            <div id="result-mask" class="hide"></div>
            <div class="search-area">
                
                    <input id="search-key" type="search" autocomplete="off" placeholder="搜点什么呢?">
                    <button type="button" class="search-form-submit" id="search-local">站内搜索</button>
                
                
            </div>
            <div id="result-wrap" class="hide">
                <div id="search-result"></div>
            </div>
            <div class="hide">
                <template id="search-tpl">
                    <div class="item">
                        <a href="/{path}" title="{title}">
                            <div class="title">{title}</div>
                            <div class="content">{content}</div>
                        </a>
                    </div>
                </template>
            </div>
        </div>
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=298 height=52 src="https://music.163.com/outchain/player?type=1&id=34930257&auto=0&height=32"></iframe>
           </div>


        
        
    <div class="widget notification">
        <h3 class="title">网站公告</h3>
        <div>
            <p>
<a href="https://spring4all.com" target="_blank">Spring For All社区</a>
是关于Spring的纯技术交流社区（涵盖Spring Boot、Spring Cloud等内容），集诸多开源爱好者和技术大牛贡献内容和交流问题。我们不夸大、不装逼、做最纯粹的技术分享！！！
<hr/>小编GITHUB开源项目,接受贡献,不限于提交问题与需求，修复代码。欢迎Pull Request<br/>支持一下：<a href="https://github.com/lxchinesszz">Star一下</a>
<hr/>专注于程序猿技术的提升的博客,欢迎投稿 <a href="mailto:lxchinesszz@163.com">投稿邮箱</a>
</p>
        </div>
    </div>

        
        
    <div class="widget">
      <h3 class="title">社交</h3> 
        <div class="content social">
            
	            <a href="https://github.com/lxchinesszz" rel="external nofollow" title="Github" target="_blank">
			    	<i class="github fa fa-github"></i>
			    </a>
            
	            <a href="mailto:lxchinesszz@163.com" rel="external nofollow" title="邮箱" target="_blank">
			    	<i class="envelope fa fa-envelope"></i>
			    </a>
            
	            <a href="https://wpa.qq.com/msgrd?v=3&uin=1213327162&site=qq&menu=yes" rel="external nofollow" title="联系QQ" target="_blank">
			    	<i class="qq fa fa-qq"></i>
			    </a>
            
        </div>
    </div>


        
        
    <div class="widget">
        <h3 class="title">分类</h3>
        <ul class="category-list"><li class="category-list-item"><a class="category-list-link current" href="/categories/Spring-Cloud/"><i class="fa" aria-hidden="true">Spring Cloud</i></a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Spring-Boot/"><i class="fa" aria-hidden="true">Spring-Boot</i></a><span class="category-list-count">42</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Spring-Boot2-0/"><i class="fa" aria-hidden="true">Spring-Boot2.0</i></a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/about/"><i class="fa" aria-hidden="true">about</i></a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据处理/"><i class="fa" aria-hidden="true">数据处理</i></a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/杂记/"><i class="fa" aria-hidden="true">杂记</i></a><span class="category-list-count">16</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/通信/"><i class="fa" aria-hidden="true">通信</i></a><span class="category-list-count">2</span></li></ul>
    </div>


        
        
  <div class="widget">
    <h3 class="title">标签云</h3>
    <div class="content tag-cloud">
        <a href="/tags/GC/" style="font-size: 10px;">GC</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/JDK/" style="font-size: 10px;">JDK</a> <a href="/tags/Linux服务器/" style="font-size: 10px;">Linux服务器</a> <a href="/tags/Netty/" style="font-size: 12px;">Netty</a> <a href="/tags/Rabbitmq/" style="font-size: 16px;">Rabbitmq</a> <a href="/tags/Spring-Cloud/" style="font-size: 12px;">Spring Cloud</a> <a href="/tags/Spring-Boot/" style="font-size: 20px;">Spring-Boot</a> <a href="/tags/Spring-Boot2-0/" style="font-size: 10px;">Spring-Boot2.0</a> <a href="/tags/Spring定时器/" style="font-size: 10px;">Spring定时器</a> <a href="/tags/Spring整合Quartz/" style="font-size: 10px;">Spring整合Quartz</a> <a href="/tags/博客搭建/" style="font-size: 10px;">博客搭建</a> <a href="/tags/日志/" style="font-size: 14px;">日志</a> <a href="/tags/服务器/" style="font-size: 18px;">服务器</a> <a href="/tags/杂记/" style="font-size: 10px;">杂记</a> <a href="/tags/深浅拷贝/" style="font-size: 10px;">深浅拷贝</a> <a href="/tags/线程/" style="font-size: 10px;">线程</a>
    </div>
  </div>


        
        
    <div class="widget">
        <h3 class="title">友情链接</h3>
        <div class="content friends-link">
        
            <a href="https://www.jianshu.com/u/e210c8fa704f" class="fa" target="_blank">简书</a>
        
            <a href="https://blog.csdn.net/message_lx" class="fa" target="_blank">CSDN</a>
        
            <a href="https://www.toutiao.com/c/user/3686495601/#mid=1563737358895105" class="fa" target="_blank">头条</a>
        
        </div>
    </div>


        
    </aside>

            </div>
        </div>
    </section>
    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>


<footer class="main-footer">
    <div class="container">
        <div class="row">
        </div>
        <span id="busuanzi_container_site_pv">
            本站总访问量<span id="busuanzi_value_site_pv"></span>次
        </span>
        |
        <span id="busuanzi_container_site_uv">
          本站访客数<span id="busuanzi_value_site_uv"></span>人次
        </span>
    </div>
</footer>

<a id="back-to-top" class="hide">
	<i class="fa fa-chevron-up"></i>
</a>


<!--page counter part统计文章字数,核心代码;来源:http://crescentmoon.info/2014/12/11/popular-widget/-->
<script>
    function addCount (Counter) {
        url=$('.article-date').attr('href').trim();
        title = $('.article-title').text().trim();
        var query=new AV.Query(Counter);
        //use url as unique idnetfication
        query.equalTo("url",url);
        query.find({
            success: function(results){
                if(results.length>0)
                {
                    var counter=results[0];
                    counter.fetchWhenSave(true); //get recent result
                    counter.increment("time");
                    counter.save();
                }
                else
                {
                    var newcounter=new Counter();
                    newcounter.set("title",title);
                    newcounter.set("url",url);
                    newcounter.set("time",1);
                    newcounter.save(null,{
                        success: function(newcounter){
                            //alert('New object created');
                        },
                        error: function(newcounter,error){
                            alert('Failed to create');
                        }
                    });
                }
            },
            error: function(error){
                //find null is not a error
                alert('Error:'+error.code+" "+error.message);
            }
        });
    }
    $(function(){
        var Counter=AV.Object.extend("Counter");
        //only increse visit counting when intering a page
        if ($('.article-title').length == 1)
            addCount(Counter);
        var query=new AV.Query(Counter);
        query.descending("time");
        // the sum of popular posts
        query.limit(10);
        query.find({
                success: function(results){
                    for(var i=0;i<results.length;i++)
                    {
                        var counter=results[i];
                        title=counter.get("title");
                        url=counter.get("url");
                        time=counter.get("time");
                        // add to the popularlist widget
                        showcontent=title+" ("+time+")";
                        //notice the "" in href
                        $('.popularlist').append('<li><a href="'+url+'">'+showcontent+'</a></li>');
                    }
                },
                error: function(error){
                    alert("Error:"+error.code+" "+error.message);
                }
            }
        )
    });
</script>
    <div class="copyright">
    <div class="container">
        <div class="row">
            <div class="col-sm-12"> 
                <span>Copyright &copy; 2018
                </span> |
                <span>
                    The Blog by <a href="个人介绍" class="copyright-links" target="_blank" rel="nofollow">liuxin</a>
                </span>
            </div>
        </div>
    </div>
</div>



	<script src="/js/search.js?rev=@@hash"></script>


<script src="/js/app.js?rev=@@hash"></script>


</body>
</html>